<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="生活，我们是认真的！">
<meta property="og:type" content="website">
<meta property="og:title" content="Shining Moon">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="Shining Moon">
<meta property="og:description" content="生活，我们是认真的！">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Shining Moon">
<meta name="twitter:description" content="生活，我们是认真的！">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/6/"/>





  <title> Shining Moon </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Shining Moon</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/06/13/Z02-canvas常用API/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qcyue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/tx1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shining Moon">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/13/Z02-canvas常用API/" itemprop="url">
                  canvas常用API
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-06-13T00:00:00+08:00">
                2016-06-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/canvas/" itemprop="url" rel="index">
                    <span itemprop="name">canvas</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="基本图形绘制"><a href="#基本图形绘制" class="headerlink" title="基本图形绘制"></a>基本图形绘制</h1><h2 id="绘制矩形"><a href="#绘制矩形" class="headerlink" title="绘制矩形"></a>绘制矩形</h2><ul>
<li>rect();没有自己独立的路径，需要配合stroke()</li>
<li>strokeRect();有独立的路径，不需要显式的调用stroke()</li>
<li>fillRect();有独立的路径，不需要显式的进行填充</li>
<li>clearRect();清空指定的矩形区域<blockquote>
<p>参数：x,y,width,height</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">600</span> <span class="attr">height</span>=<span class="string">400</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    ctx.rect(<span class="number">100</span>,<span class="number">100</span>,<span class="number">200</span>,<span class="number">100</span>);</div><div class="line">    <span class="comment">//需要调用stroke()</span></div><div class="line">   	ctx.stroke();</div><div class="line">    <span class="comment">//有独立的路径，不需要显式的调用stroke()</span></div><div class="line">	<span class="comment">//ctx.strokeRect(100,100,200,240);</span></div><div class="line">    <span class="comment">//有独立的路径，不需要显式的进行填充</span></div><div class="line">    ctx.fillRect(<span class="number">100</span>,<span class="number">100</span>,<span class="number">200</span>,<span class="number">100</span>);</div><div class="line">    <span class="comment">//清空指定的矩形区域</span></div><div class="line">    ctx.clearRect(<span class="number">100</span>,<span class="number">100</span>,<span class="number">100</span>,<span class="number">100</span>);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<h2 id="save和restore方法"><a href="#save和restore方法" class="headerlink" title="save和restore方法"></a>save和restore方法</h2><ul>
<li>save()保存当前绘制的状态</li>
<li>restore()恢复上次绘制的状态<br><strong>save可以保存多次绘制状态，以栈的形式存储</strong><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">600</span> <span class="attr">height</span>=<span class="string">400</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    ctx.rect(<span class="number">100</span>,<span class="number">100</span>,<span class="number">200</span>,<span class="number">200</span>);</div><div class="line">    ctx.strokeStyle = <span class="string">"black"</span>;</div><div class="line">    ctx.lineWidth = <span class="number">5</span>;</div><div class="line">    ctx.fillStyle = <span class="string">"orangered"</span>;</div><div class="line">    ctx.stroke();</div><div class="line">    ctx.fill();</div><div class="line">    <span class="comment">//保存上次绘制状态</span></div><div class="line">    <span class="comment">//可以保存多次，以栈格式存储，后进先出</span></div><div class="line">    ctx.save();</div><div class="line">    ctx.beginPath();</div><div class="line">    ctx.rect(<span class="number">200</span>,<span class="number">200</span>,<span class="number">150</span>,<span class="number">150</span>);</div><div class="line">    ctx.stroke();</div><div class="line">    ctx.fillStyle = <span class="string">"yellow"</span>;</div><div class="line">    ctx.fill();</div><div class="line">    ctx.beginPath();</div><div class="line">    <span class="comment">//恢复上次绘制状态</span></div><div class="line">    ctx.restore();</div><div class="line">    ctx.rect(<span class="number">50</span>,<span class="number">50</span>,<span class="number">80</span>,<span class="number">80</span>);</div><div class="line">    ctx.stroke();</div><div class="line">    ctx.fill();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="绘制圆弧"><a href="#绘制圆弧" class="headerlink" title="绘制圆弧"></a>绘制圆弧</h2><blockquote>
<p>arc(x,y,r,startAngle,endAngle,bool);<br>参数：圆心，半径，起始的角度，结束的角度，是否逆时针。默认是false，顺时针；true：逆时针</p>
<ul>
<li>绘制简单圆弧<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">600</span> <span class="attr">height</span>=<span class="string">400</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">	<span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    <span class="comment">//绘制圆弧 arc</span></div><div class="line">    <span class="comment">//加上moveTo()会加上一条半径</span></div><div class="line">    <span class="comment">//ctx.moveTo(200,200);</span></div><div class="line">    ctx.arc(<span class="number">200</span>,<span class="number">200</span>,<span class="number">100</span>,<span class="number">0</span>,-<span class="built_in">Math</span>.PI/<span class="number">2</span>);<span class="comment">//默认是顺时针false，true表示逆时针</span></div><div class="line">    ctx.stroke();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<ul>
<li><p>绘制带有圆角的矩形</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">600</span> <span class="attr">height</span>=<span class="string">400</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="comment">/**</span></div><div class="line">     *  绘制连续的路径，如果前面的终点和后面的起点一样，就不需要重新设置moveTo()</div><div class="line">     */</div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    ctx.lineWidth = <span class="number">3</span>;</div><div class="line">    ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">    ctx.lineTo(<span class="number">300</span>,<span class="number">100</span>);</div><div class="line"><span class="comment">//在画圆弧时，上面的直线会对圆弧的绘制造成影响，所以需要从上面直线的终点开始绘制圆弧</span></div><div class="line">    ctx.arc(<span class="number">300</span>,<span class="number">120</span>,<span class="number">20</span>,-<span class="built_in">Math</span>.PI/<span class="number">2</span>,<span class="number">0</span>,<span class="literal">true</span>);</div><div class="line"><span class="comment">//因为圆弧的终点与下一条直线的起始点相同，所以此处不需要moveTo()</span></div><div class="line"><span class="comment">//    ctx.moveTo(320,120);</span></div><div class="line">    ctx.lineTo(<span class="number">320</span>,<span class="number">170</span>);</div><div class="line">    ctx.arc(<span class="number">300</span>,<span class="number">170</span>,<span class="number">20</span>,<span class="number">0</span>,<span class="built_in">Math</span>.PI/<span class="number">2</span>,<span class="literal">true</span>);</div><div class="line"><span class="comment">//    ctx.moveTo(300,190);</span></div><div class="line">    ctx.lineTo(<span class="number">100</span>,<span class="number">190</span>);</div><div class="line">    ctx.arc(<span class="number">100</span>,<span class="number">170</span>,<span class="number">20</span>,<span class="built_in">Math</span>.PI/<span class="number">2</span>,<span class="built_in">Math</span>.PI,<span class="literal">true</span>);</div><div class="line"><span class="comment">//    ctx.moveTo(80,170);</span></div><div class="line">    ctx.lineTo(<span class="number">80</span>,<span class="number">120</span>);</div><div class="line">    ctx.arc(<span class="number">100</span>,<span class="number">120</span>,<span class="number">20</span>,<span class="built_in">Math</span>.PI,<span class="built_in">Math</span>.PI*<span class="number">3</span>/<span class="number">2</span>,<span class="literal">true</span>);</div><div class="line"></div><div class="line">    ctx.stroke();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>封装彩虹</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">600</span> <span class="attr">height</span>=<span class="string">400</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Rainbow</span>(<span class="params">ctx</span>) </span>&#123;</div><div class="line">        <span class="keyword">this</span>.ctx = ctx;</div><div class="line">    &#125;</div><div class="line">    Rainbow.prototype.init = <span class="function"><span class="keyword">function</span> (<span class="params">width,rgbs</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> perWidth = width/<span class="number">6</span>;</div><div class="line">        <span class="keyword">this</span>.ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++)&#123;</div><div class="line">            <span class="comment">//如果不相等，则每个的进度等于后一个的值减去前一个的值除以总共变化的次数</span></div><div class="line">            <span class="keyword">var</span> r = rgbs[i+<span class="number">1</span>].r==rgbs[i].r?<span class="number">0</span>:(rgbs[i+<span class="number">1</span>].r-rgbs[i].r)/perWidth;</div><div class="line">            <span class="keyword">var</span> g = rgbs[i+<span class="number">1</span>].g==rgbs[i].g?<span class="number">0</span>:(rgbs[i+<span class="number">1</span>].g-rgbs[i].g)/perWidth;</div><div class="line">            <span class="keyword">var</span> b = rgbs[i+<span class="number">1</span>].b==rgbs[i].b?<span class="number">0</span>:(rgbs[i+<span class="number">1</span>].b-rgbs[i].b)/perWidth;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>;j&lt;perWidth;j++)&#123;</div><div class="line">                <span class="comment">//判断每个颜色两次变化是否为0，为0则取固定的值，不为零则在原来的基础上加上每次的变化值</span></div><div class="line">                <span class="keyword">var</span> color1 = r==<span class="number">0</span>?rgbs[i].r:<span class="built_in">parseInt</span>(rgbs[i].r+r*j);</div><div class="line">                <span class="keyword">var</span> color2 = g==<span class="number">0</span>?rgbs[i].g:<span class="built_in">parseInt</span>(rgbs[i].g+g*j);</div><div class="line">                <span class="keyword">var</span> color3 = b==<span class="number">0</span>?rgbs[i].b:<span class="built_in">parseInt</span>(rgbs[i].b+b*j);</div><div class="line">                <span class="keyword">this</span>.ctx.beginPath();</div><div class="line">                <span class="keyword">this</span>.ctx.strokeStyle = <span class="string">"rgb("</span>+color1+<span class="string">","</span>+color2+<span class="string">","</span>+color3+<span class="string">")"</span>;</div><div class="line">                <span class="keyword">this</span>.ctx.moveTo(<span class="number">100</span>,perWidth*i+<span class="number">100</span>+j);</div><div class="line">                <span class="keyword">this</span>.ctx.lineTo(<span class="number">500</span>,perWidth*i+<span class="number">100</span>+j);</div><div class="line">                <span class="keyword">this</span>.ctx.stroke();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">var</span> rgbs = [&#123;<span class="comment">//红</span></div><div class="line">            r:<span class="number">255</span>,</div><div class="line">            <span class="attr">g</span>:<span class="number">0</span>,</div><div class="line">            <span class="attr">b</span>:<span class="number">0</span></div><div class="line">        &#125;,&#123;<span class="comment">//橙</span></div><div class="line">            r:<span class="number">255</span>,</div><div class="line">            <span class="attr">g</span>:<span class="number">127</span>,</div><div class="line">            <span class="attr">b</span>:<span class="number">0</span></div><div class="line">        &#125;,&#123;<span class="comment">//黄</span></div><div class="line">            r:<span class="number">255</span>,</div><div class="line">            <span class="attr">g</span>:<span class="number">255</span>,</div><div class="line">            <span class="attr">b</span>:<span class="number">0</span></div><div class="line">        &#125;,&#123;<span class="comment">//绿</span></div><div class="line">            r:<span class="number">0</span>,</div><div class="line">            <span class="attr">g</span>:<span class="number">255</span>,</div><div class="line">            <span class="attr">b</span>:<span class="number">0</span></div><div class="line">        &#125;,&#123;<span class="comment">//青</span></div><div class="line">            r:<span class="number">0</span>,</div><div class="line">            <span class="attr">g</span>:<span class="number">127</span>,</div><div class="line">            <span class="attr">b</span>:<span class="number">255</span></div><div class="line">        &#125;,&#123;<span class="comment">//蓝</span></div><div class="line">            r:<span class="number">0</span>,</div><div class="line">            <span class="attr">g</span>:<span class="number">0</span>,</div><div class="line">            <span class="attr">b</span>:<span class="number">255</span></div><div class="line">        &#125;,&#123;<span class="comment">//紫</span></div><div class="line">            r:<span class="number">139</span>,</div><div class="line">            <span class="attr">g</span>:<span class="number">0</span>,</div><div class="line">            <span class="attr">b</span>:<span class="number">255</span></div><div class="line">        &#125;];</div><div class="line">    <span class="keyword">var</span> rain = <span class="keyword">new</span> Rainbow(ctx);</div><div class="line">    rain.init(<span class="number">180</span>,rgbs);</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="绘制文本"><a href="#绘制文本" class="headerlink" title="绘制文本"></a>绘制文本</h2><ul>
<li>strokeText()：空心文字</li>
<li>fillText():实心文字</li>
<li>文本的对齐方式<ul>
<li>水平对齐：textAlign –&gt;  left center right start end</li>
<li>垂直对齐：textBaseline –&gt;  top middle bottom  </li>
</ul>
</li>
<li>获取文本宽度 measureText<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">600</span> <span class="attr">height</span>=<span class="string">400</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    <span class="keyword">var</span> str = <span class="string">"人生如戏"</span>;</div><div class="line">    ctx.font=<span class="string">"48px microsoft yahei"</span>;</div><div class="line">    ctx.textAlign = <span class="string">"center"</span>;</div><div class="line">    ctx.textBaseline = <span class="string">"bottom"</span>;</div><div class="line">    </div><div class="line">    ctx.strokeText(str,<span class="number">100</span>,<span class="number">100</span>);<span class="comment">//空心文字</span></div><div class="line"><span class="comment">//    ctx.fillText(str,100,100);//实心文字</span></div><div class="line"><span class="comment">//在文字下方画一条和文本宽度相等的线</span></div><div class="line">	<span class="keyword">var</span> obj = ctx.measureText(str);</div><div class="line">    ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">    ctx.lineTo(<span class="number">100</span>+obj.width,<span class="number">100</span>);</div><div class="line">    ctx.stroke();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="绘制图片"><a href="#绘制图片" class="headerlink" title="绘制图片"></a>绘制图片</h2><ul>
<li>drawImage()</li>
<li><p>三个参数：图片对象   放置的位置(x,y)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">600</span> <span class="attr">height</span>=<span class="string">400</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> Image();</div><div class="line">    img.src = <span class="string">"img/xiang.jpg"</span>;</div><div class="line">    <span class="comment">//必须等图片加载完毕后才能绘制图片</span></div><div class="line">    img.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        ctx.drawImage(img,<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">    &#125;;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p><img src="../img/da.png" alt="csc"></p>
</li>
<li><p>五个参数 ：图片对象，放置的位置(x,y),图片的大小(width,height)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">600</span> <span class="attr">height</span>=<span class="string">400</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> Image();</div><div class="line">    img.src = <span class="string">"img/xiang.jpg"</span>;</div><div class="line">    <span class="comment">//必须等图片加载完毕后才能绘制图片</span></div><div class="line">    img.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        ctx.drawImage(img,<span class="number">100</span>,<span class="number">100</span>,<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">        <span class="comment">//会根据设置的参数对图片进行缩放，不会把图片裁剪</span></div><div class="line">    &#125;;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>效果图<br>  <img src="../img/xiao.png" alt="csc"></p>
</li>
<li>九个参数：图片对象，图片中的坐标，要显示的图片的宽高，放置的位置，图片的大小<ul>
<li>可以用于绘制逐帧动画,需要结合setTimeout()或者requestAnimationFrame() <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">600</span> <span class="attr">height</span>=<span class="string">400</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> Image();</div><div class="line">    <span class="comment">//需要准备精灵图，让图片进行切换，实现动画效果</span></div><div class="line">    img.src = <span class="string">"img/rabbit.png"</span>;</div><div class="line">    <span class="keyword">var</span> allWidth = <span class="number">160</span>;</div><div class="line">    <span class="keyword">var</span> allHeight = <span class="number">260</span>;</div><div class="line">    <span class="comment">//一共四帧</span></div><div class="line">    <span class="keyword">var</span> num = <span class="number">4</span>;</div><div class="line">    <span class="keyword">var</span> nowIndex = <span class="number">0</span>;</div><div class="line">    <span class="keyword">var</span> perHeight = allHeight/num;</div><div class="line">    <span class="keyword">var</span> perWidth = allWidth/num;</div><div class="line">    img.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        render();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    	<span class="comment">//每次切换时先清空画布</span></div><div class="line">        ctx.clearRect(<span class="number">0</span>,<span class="number">0</span>,cas.width,cas.height);</div><div class="line">	ctx.drawImage(img,perWidth*nowIndex,<span class="number">0</span>,perWidth,perHeight,cas.width/<span class="number">2</span>-perWidth/<span class="number">2</span>,cas.height/<span class="number">2</span>-perHeight/<span class="number">2</span>,perWidth,perHeight);</div><div class="line">        nowIndex++;</div><div class="line">        <span class="keyword">if</span>(nowIndex==<span class="number">4</span>)&#123;</div><div class="line">            nowIndex=<span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        setTimeout(render,<span class="number">100</span>);</div><div class="line">    &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="变换"><a href="#变换" class="headerlink" title="变换"></a>变换</h2><blockquote>
<p>坐标轴的变换，不影响变换之前绘制的图形，但是会影响变换之后的图形</p>
<ul>
<li>translate(x,y):将坐标原点进行位移</li>
<li>rotate(angle):以坐标原点为中心将坐标轴进行旋转（弧度）</li>
<li>scale(ratex,ratey):将图形进行缩放</li>
<li>在同一个画布中绘制一个旋转的正方形和固定的正方形<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">600</span> <span class="attr">height</span>=<span class="string">400</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    <span class="keyword">var</span> speed = <span class="built_in">Math</span>.PI/<span class="number">90</span>;</div><div class="line">    <span class="keyword">var</span> index = <span class="number">0</span>;</div><div class="line">    <span class="comment">//移动坐标原点至画布中心</span></div><div class="line">    ctx.translate(cas.width/<span class="number">2</span>,cas.height/<span class="number">2</span>);</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        ctx.clearRect(-cas.width/<span class="number">2</span>,-cas.height/<span class="number">2</span>,cas.width,cas.height);</div><div class="line">        ctx.strokeRect(-cas.width/<span class="number">2</span>,-cas.height/<span class="number">2</span>,<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">        ctx.save();<span class="comment">//保存的状态包括平移，旋转，缩放和基本样式设置</span></div><div class="line">        ctx.rotate(speed*index);<span class="comment">//以坐标原点为中心进行旋转</span></div><div class="line">        ctx.strokeRect(<span class="number">-50</span>,<span class="number">-50</span>,<span class="number">100</span>,<span class="number">100</span>);<span class="comment">//绘制的是旋转的矩形</span></div><div class="line">        ctx.restore();<span class="comment">//恢复固定的矩形，此时会将rotate重置为0</span></div><div class="line">   <span class="comment">//恢复状态的时候，会将重新设置绘制状态，即将rotate状态重新设置保存时的状态，即为零</span></div><div class="line">   <span class="comment">//恢复原来状态之后，旋转角度依然从零开始，所以要想达到旋转效果，必须逐渐增大角度</span></div><div class="line">        index++;</div><div class="line">        <span class="keyword">if</span>(speed*index &gt; <span class="number">2</span>*<span class="built_in">Math</span>.PI)&#123;</div><div class="line">            index = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        requestAnimationFrame(render);</div><div class="line">    &#125;</div><div class="line">    render();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/06/10/Z01-canvas基本使用 /">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qcyue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/tx1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shining Moon">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/10/Z01-canvas基本使用 /" itemprop="url">
                  canvas基本使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-06-10T00:00:00+08:00">
                2016-06-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/canvas/" itemprop="url" rel="index">
                    <span itemprop="name">canvas</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Canvas基础"><a href="#Canvas基础" class="headerlink" title="Canvas基础"></a>Canvas基础</h1><blockquote>
<p>canvas : 画布默认宽高是300x150;<br>canvas的宽高要使用canvas标签的属性设置，不能使用css设置</p>
<ul>
<li>简单画一条直线<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">"600"</span> <span class="attr">height</span>=<span class="string">"400"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="built_in">console</span>.log(cas.height);</div><div class="line">    <span class="built_in">console</span>.log(cas.width);</div><div class="line">    <span class="comment">//获取画图工具</span></div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    <span class="comment">//指定画图的起点</span></div><div class="line">    ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">    <span class="comment">//画路径</span></div><div class="line">    ctx.lineTo(<span class="number">300</span>,<span class="number">100</span>);</div><div class="line">    <span class="comment">//描边</span></div><div class="line">    ctx.stroke();</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<ul>
<li>绘制矩形<blockquote>
<p><strong>非零环绕原则(填充的原则)：</strong>从闭合区域中画一条线，这条线经过的线条中，如果正向与反向的线条相互抵消，则不填充</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"> <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">"600"</span> <span class="attr">height</span>=<span class="string">"400"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">   <span class="comment">//绘制正方形</span></div><div class="line">   <span class="comment">//ctx.closePath()作用是闭合路径</span></div><div class="line">   <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">   <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">   ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">   ctx.lineTo(<span class="number">300</span>,<span class="number">100</span>);</div><div class="line">   ctx.lineTo(<span class="number">300</span>,<span class="number">300</span>);</div><div class="line">   ctx.lineTo(<span class="number">100</span>,<span class="number">300</span>);</div><div class="line">   ctx.lineTo(<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">   ctx.closePath();<span class="comment">//闭合路径</span></div><div class="line"><span class="comment">//绘制内部矩形</span></div><div class="line">   ctx.moveTo(<span class="number">150</span>,<span class="number">150</span>);</div><div class="line">   ctx.lineTo(<span class="number">150</span>,<span class="number">250</span>);</div><div class="line">   ctx.lineTo(<span class="number">250</span>,<span class="number">250</span>);</div><div class="line">   ctx.lineTo(<span class="number">250</span>,<span class="number">150</span>);</div><div class="line">   ctx.lineTo(<span class="number">150</span>,<span class="number">150</span>);</div><div class="line">   ctx.closePath();</div><div class="line">   <span class="comment">//设置线的颜色</span></div><div class="line">   ctx.strokeStyle =<span class="string">"red"</span>;</div><div class="line">   <span class="comment">//设置线的宽度</span></div><div class="line">   ctx.lineWidth = <span class="number">10</span>;</div><div class="line">   ctx.stroke();</div><div class="line">   <span class="comment">//填充</span></div><div class="line">   ctx.fill();</div><div class="line"> <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<blockquote>
<p>手动闭合路径和closePath()<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">"600"</span> <span class="attr">height</span>=<span class="string">"400"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="comment">//手动闭合路径和closePath()闭合路径</span></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 如果线宽较大，会明显缺角，补上这个角需要多加一个点</div><div class="line">     *closePath()闭合路径可以省略最后一条线</div><div class="line">     */</div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    ctx.lineWidth = <span class="number">10</span>;</div><div class="line">    ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">    ctx.lineTo(<span class="number">300</span>,<span class="number">100</span>);</div><div class="line">    ctx.lineTo(<span class="number">300</span>,<span class="number">300</span>);</div><div class="line">    <span class="comment">//如果使用closePath().可以省略下面1,2两条代码</span></div><div class="line">    ctx.lineTo(<span class="number">100</span>,<span class="number">100</span>);<span class="comment">//1</span></div><div class="line">    <span class="comment">//手动闭合</span></div><div class="line">    ctx.lineTo(<span class="number">101</span>,<span class="number">100</span>);<span class="comment">//2</span></div><div class="line"><span class="comment">//    ctx.closePath();</span></div><div class="line">    ctx.stroke();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
</blockquote>
<ul>
<li>绘制曲线<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">"600"</span> <span class="attr">height</span>=<span class="string">"400"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    <span class="comment">//绘制曲线：画一个一个的点，点的路线符合方程曲线的规律</span></div><div class="line">    ctx.moveTo(<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">1000</span>;i++)&#123;</div><div class="line">        <span class="keyword">var</span> x = i;</div><div class="line">        <span class="comment">//正弦曲线</span></div><div class="line">        <span class="keyword">var</span> y = <span class="number">100</span>*<span class="built_in">Math</span>.sin(x/<span class="number">50</span>)+<span class="number">100</span>;</div><div class="line">        ctx.lineTo(x,y);</div><div class="line">    &#125;</div><div class="line">    ctx.stroke();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="常用属性"><a href="#常用属性" class="headerlink" title="常用属性"></a>常用属性</h2><ul>
<li>lineWidth:线宽</li>
<li>strokeStyle：线的颜色</li>
<li>fillStyle：填充颜色</li>
<li>lineCap:线末端的类型，默认是butt，可以设置round、square</li>
<li>lineJion:相交线的拐点类型，默认是miter，可设置round，bevel</li>
<li>setLineDash():设置虚线,参数是一个数组，设置黑白切换<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cas"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid blue;"</span> <span class="attr">width</span>=<span class="string">600</span> <span class="attr">height</span>=<span class="string">400</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"cas"</span>);</div><div class="line">    <span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</div><div class="line">    ctx.lineWidth = <span class="number">50</span>;</div><div class="line">    ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</div><div class="line">    ctx.lineTo(<span class="number">400</span>,<span class="number">100</span>);</div><div class="line">    ctx.setLineDash([<span class="number">10</span>,<span class="number">15</span>,<span class="number">20</span>]);</div><div class="line">    ctx.stroke();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/22/C08-SVG/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qcyue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/tx1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shining Moon">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/22/C08-SVG/" itemprop="url">
                  what is SVG?
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-05-22T00:00:00+08:00">
                2016-05-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/HTML5/" itemprop="url" rel="index">
                    <span itemprop="name">HTML5</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="什么是SVG？"><a href="#什么是SVG？" class="headerlink" title="什么是SVG？"></a>什么是SVG？</h1><ul>
<li>SVG 指可伸缩矢量图形 (Scalable Vector Graphics)</li>
<li>SVG 用于定义用于网络的基于矢量的图形</li>
<li>SVG 使用 XML 格式定义图形</li>
<li>SVG 图像在放大或改变尺寸的情况下其图形质量不会有损失</li>
<li>SVG 是万维网联盟的标准</li>
</ul>
<h1 id="SVG优势"><a href="#SVG优势" class="headerlink" title="SVG优势"></a>SVG优势</h1><ul>
<li>与其他图像格式相比（比如 JPEG 和 GIF），使用 SVG 的优势在于：<ul>
<li>SVG 图像可通过文本编辑器来创建和修改</li>
<li>SVG 图像可被搜索、索引、脚本化或压缩</li>
<li>SVG 是可伸缩的</li>
<li>SVG 图像可在任何的分辨率下被高质量地打印</li>
<li>SVG 可在图像质量不下降的情况下被放大</li>
</ul>
</li>
</ul>
<h1 id="把-SVG-直接嵌入-HTML-页面"><a href="#把-SVG-直接嵌入-HTML-页面" class="headerlink" title="把 SVG 直接嵌入 HTML 页面"></a>把 SVG 直接嵌入 HTML 页面</h1><p>在 HTML5 中，可以将 SVG 元素直接嵌入 HTML 页面中：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">version</span>=<span class="string">"1.1"</span> <span class="attr">height</span>=<span class="string">"190"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">polygon</span> <span class="attr">points</span>=<span class="string">"100,10 40,180 190,60 10,60 160,180"</span></span></div><div class="line">  <span class="attr">style</span>=<span class="string">"fill:lime;stroke:purple;stroke-width:5;fill-rule:evenodd;"</span>&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h1 id="SVG-与-Canvas两者间的区别"><a href="#SVG-与-Canvas两者间的区别" class="headerlink" title="SVG 与 Canvas两者间的区别"></a>SVG 与 Canvas两者间的区别</h1><ul>
<li>SVG 是一种使用 XML 描述 2D 图形的语言。</li>
<li>Canvas 通过 JavaScript 来绘制 2D 图形。</li>
<li>SVG 基于 XML，这意味着 SVG DOM 中的每个元素都是可用的。可以为某个元素附加 JavaScript 事件处理器。</li>
<li>在 SVG 中，每个被绘制的图形均被视为对象。如果SVG对象的属性发生变化，那么浏览器能够自动重现图形。</li>
<li>Canvas 是逐像素进行渲染的。在 canvas 中，一旦图形被绘制完成，它就不会继续得到浏览器的关注。如果其位置发生变化，那么整个场景也需要重新绘制，包括任何或许已被图形覆盖的对象。</li>
</ul>
<h1 id="Canvas-与-SVG-的比较"><a href="#Canvas-与-SVG-的比较" class="headerlink" title="Canvas 与 SVG 的比较"></a>Canvas 与 SVG 的比较</h1><table>
<thead>
<tr>
<th>Canvas</th>
<th>SVG</th>
</tr>
</thead>
<tbody>
<tr>
<td>依赖分辨率</td>
<td>不依赖分辨率</td>
</tr>
<tr>
<td>不支持事件处理器</td>
<td>支持事件处理器</td>
</tr>
<tr>
<td>弱的文本渲染能力</td>
<td>适合带有大型渲染区域的应用程序（比如谷歌地图）</td>
</tr>
<tr>
<td>能够以 .png 或 .jpg 格式保存结果图像</td>
<td>复杂度高会减慢渲染速度（任何过度使用 DOM 的应用都不快）</td>
</tr>
<tr>
<td>最适合图像密集型的游戏，其中的许多对象会被频繁重绘</td>
<td>不适合游戏应用</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/15/C07-webStorage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qcyue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/tx1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shining Moon">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/15/C07-webStorage/" itemprop="url">
                  web Storage
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-05-15T00:00:00+08:00">
                2016-05-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/HTML5/" itemprop="url" rel="index">
                    <span itemprop="name">HTML5</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="web-Storage"><a href="#web-Storage" class="headerlink" title="web Storage"></a>web Storage</h1><ul>
<li>html5中的Web Storage包括了两种存储方式：sessionStorage和localStorage。sessionStorage用于本地存储一个会话（session）中的数据，这些数据只有在同一个会话中的页面才能访问并且当会话结束后数据也随之销毁。</li>
<li>因此sessionStorage不是一种持久化的本地存储，仅仅是会话级别的存储。而localStorage用于持久化的本地存储，除非主动删除数据，否则数据是永远不会过期的。  </li>
<li>浏览器的支持除了IE７及以下不支持外，其他标准浏览器都完全支持</li>
</ul>
<h2 id="web-storage和cookie的区别"><a href="#web-storage和cookie的区别" class="headerlink" title="web storage和cookie的区别"></a>web storage和cookie的区别</h2><ul>
<li>Web Storage的概念和cookie相似，区别是它是为了更大容量存储设计的。Cookie的大小是受限的，并且每次你请求一个新的页面的时候Cookie都会被发送过去，这样无形中浪费了带宽，另外cookie还需要指定作用域，不可以跨域调用。</li>
<li>除此之外，Web Storage拥有setItem,getItem,removeItem,lear等方法，不像cookie需要前端开发者自己封装setCookie，getCookie。</li>
<li>但是Cookie也是不可以或缺的：Cookie的作用是与服务器进行交互，作为HTTP规范的一部分而存在 ，而Web Storage仅仅是为了在本地“存储”数据而生。</li>
</ul>
<h2 id="localStorage和sessionStorage操作"><a href="#localStorage和sessionStorage操作" class="headerlink" title="localStorage和sessionStorage操作"></a>localStorage和sessionStorage操作</h2><ul>
<li>localStorage和sessionStorage都具有相同的操作方法，例如setItem、getItem和removeItem等</li>
<li><p>setItem</p>
<ul>
<li>将value存储到key字段 </li>
<li>.setItem( key, value)<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sessionStorage.setItem(<span class="string">"key"</span>, <span class="string">"value"</span>);</div><div class="line">localStorage.setItem(<span class="string">"site"</span>, <span class="string">"js8.in"</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>getItem</p>
<ul>
<li>获取指定key本地存储的值</li>
<li>.getItem(key)<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> value = sessionStorage.getItem(<span class="string">"key"</span>); </div><div class="line"><span class="keyword">var</span> site = localStorage.getItem(<span class="string">"site"</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>removeItem </p>
<ul>
<li>删除指定可以本地存储的值</li>
<li>.removeItem(key)    <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sessionStorage.removeItem(<span class="string">"key"</span>); </div><div class="line">localStorage.removeItem(<span class="string">"site"</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>clear</p>
<ul>
<li>清除所有的key/value</li>
<li>.clear()<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sessionStorage.clear(); </div><div class="line">localStorage.clear();</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="localStorage和sessionStorage的key和length属性实现遍历"><a href="#localStorage和sessionStorage的key和length属性实现遍历" class="headerlink" title="localStorage和sessionStorage的key和length属性实现遍历"></a>localStorage和sessionStorage的key和length属性实现遍历</h2><ul>
<li>sessionStorage和localStorage提供的key()和length可以方便的实现存储的数据遍历<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> storage = <span class="built_in">window</span>.localStorage; </div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>, len = storage.length; i &lt; len; i++)&#123;</div><div class="line">    <span class="keyword">var</span> key = storage.key(i); </div><div class="line">    <span class="keyword">var</span> value = storage.getItem(key); </div><div class="line">    <span class="built_in">console</span>.log(key + <span class="string">"="</span> + value); </div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="storage-事件"><a href="#storage-事件" class="headerlink" title="storage 事件"></a>storage 事件</h2><ul>
<li><p>torage还提供了storage事件，当键值改变或者clear的时候，就可以触发storage事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(<span class="built_in">window</span>.addEventListener)&#123; </div><div class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">"storage"</span>,handle_storage,<span class="literal">false</span>); </div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.attachEvent)&#123; </div><div class="line">    <span class="built_in">window</span>.attachEvent(<span class="string">"onstorage"</span>,handle_storage); </div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">handle_storage</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(!e)&#123;e=<span class="built_in">window</span>.event;&#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>storage事件对象的具体属性如下表：<br>| Property |  Type  |                              Description |<br>| ——– | :—-: | —————————————: |<br>| key      | String | The named key that was added, removed, or moddified |<br>| oldValue |  Any   | The named key that was added, removed, or moddified |<br>| newValue |  Any   | The new value, or null if an item was added |<br>| url/uri  | String | The page that called the method that triggered this change |</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/12/G03-requirejs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qcyue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/tx1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shining Moon">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/12/G03-requirejs/" itemprop="url">
                  requireJS
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-05-12T00:00:00+08:00">
                2016-05-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AMD和CMD/" itemprop="url" rel="index">
                    <span itemprop="name">AMD和CMD</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="requireJs"><a href="#requireJs" class="headerlink" title="requireJs"></a>requireJs</h1><p><strong>AMD（  Asynchronous Module Definition）异步加载模块定义</strong></p>
<ul>
<li>当一个网页要引入多个外部文件，且文件之间的依赖关系较强的时候，必须保证文件的加载顺序，并且当浏览器加载外部文件的时候就会停止网页的渲染，加载的文件越多，网页失去响应的时间越长，代码的编写和维护也会很麻烦。</li>
<li>requirejs实现了js 文件的异步加载，避免网页失去响应</li>
<li>管理模块之间的依赖性，便于代码的编写和维护</li>
<li>解决了命名冲突问题（不同模块中的同名变量不会有冲突）<h2 id="requirejs的基本使用"><a href="#requirejs的基本使用" class="headerlink" title="requirejs的基本使用"></a>requirejs的基本使用</h2><strong>注意 : </strong></li>
<li>必须注意各模块之间的路径问题<h3 id="主模块"><a href="#主模块" class="headerlink" title="主模块"></a>主模块</h3></li>
<li>如果主模块不依赖于任何模块，其中的js代码可以正常编写​<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- data-main的作用是指定网页程序的主模板，即main.js。这个文件会第一个被require.js加载。main是省略了后缀名js --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"require.js"</span> <span class="attr">data-main</span>=<span class="string">"js/main"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//main.js</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"abc"</span>);</div></pre></td></tr></table></figure>
<ul>
<li>当主模块依赖于其他模块时，需要使用require函数<ul>
<li>第一个参数[“module1”,”module2”,”module3”]代表的是该模块所依赖的三个模块，第二个参数是回调函数，当前面的模块加载完毕后，会调用该函数，加载的模块会以参数的形式依次传入该回调函数，就可以在回调函数内使用这些模块</li>
<li>可以直接使用require([“module”]),表示在当前文件中加载模块<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>([<span class="string">"module1"</span>,<span class="string">"module2"</span>,<span class="string">"module3"</span>],<span class="function"><span class="keyword">function</span>(<span class="params">m1,m2,m3</span>)</span>&#123;</div><div class="line">  	<span class="built_in">console</span>.log(m1);</div><div class="line">  	<span class="built_in">console</span>.log(m2);</div><div class="line">  	<span class="built_in">console</span>.log(m3);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="自定义模块加载-require-config"><a href="#自定义模块加载-require-config" class="headerlink" title="自定义模块加载 require.config()"></a>自定义模块加载 require.config()</h3><ul>
<li>baseUrl: 显示的设置模块查找的根路径，即paths中设置的文件路径从public/js/开始<ul>
<li>如果不设置baseUrl时，根路径默认为data-main属性设置的入口文件所在的路径</li>
</ul>
</li>
<li>paths: 指定各个模块的加载路径，并为其路径设置一个名字 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>.config(&#123;</div><div class="line">  <span class="attr">baseUrl</span>:<span class="string">"public/js"</span>,</div><div class="line">  <span class="attr">paths</span>:&#123;</div><div class="line">    <span class="attr">jquery</span>:<span class="string">"jquery/jquery.min"</span>,</div><div class="line">    <span class="attr">echarts</span>:<span class="string">"echarts/echarts.min"</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="定义模块"><a href="#定义模块" class="headerlink" title="定义模块"></a>定义模块</h3><ul>
<li>使用define();<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//这是一个js文件：sum.js</span></div><div class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a,b</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> a+b;</div><div class="line">  &#125; </div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">sum</span>:sum</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>main函数加载时用法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//main.js</span></div><div class="line"><span class="built_in">require</span>([<span class="string">"sum"</span>],<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> sum = obj.sum(<span class="number">1</span>,<span class="number">2</span>);</div><div class="line">  <span class="built_in">console</span>.log(sum);<span class="comment">//3</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="非规范的模块处理"><a href="#非规范的模块处理" class="headerlink" title="非规范的模块处理"></a>非规范的模块处理</h3><ul>
<li>使用require.config()设置<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//  js/foo.js</span></div><div class="line"><span class="comment">//非规范的模块,即没有使用define定义模块</span></div><div class="line"><span class="keyword">var</span> n = <span class="number">3</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(n);  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>处理方式<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//  main.js</span></div><div class="line"><span class="built_in">require</span>.config(&#123;</div><div class="line">  <span class="attr">shim</span>:&#123;</div><div class="line">  </div><div class="line">  	<span class="comment">// 找到模块</span></div><div class="line">    <span class="string">"js/foo"</span>:&#123;</div><div class="line">    </div><div class="line">    	<span class="comment">// 设置该模块所依赖的模块</span></div><div class="line">    	deps:[<span class="string">"jquery"</span>,<span class="string">"common"</span>],</div><div class="line">    	<span class="comment">//导出非规范模块中的成员(无论是变量还是函数)，此处是定义的fn函数</span></div><div class="line">      	exports:<span class="string">"fn"</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
</blockquote>
<h1 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h1><p><strong>Sea.js 中，所有 JavaScript 模块都遵循 CMD（Common Module Definition） 模块定义规范。</strong>     </p>
<ul>
<li>在CMD规范中，一个模块就是一个文件<h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2></li>
<li>denfine() ： 定义模块，是一个全局函数  define(factory)</li>
<li>接收factory参数，可以是函数，对象，也可以是字符串。</li>
<li>define()也可以接收三个参数。define(id,deps,factory)<ul>
<li>id : 模块名称</li>
<li>deps : 模块依赖</li>
<li>factory : 模块的构造方法，处理模块代码 </li>
</ul>
</li>
<li>当factory为函数时，接收三个参数<ul>
<li>require: 是一个函数，接收一个参数，为模块名称，用来获取其他模块提供的接口<ul>
<li>若要异步加载模块 : require.async(id, [callback:可选])</li>
</ul>
</li>
<li>exports : 是一个对象，用来提供对外的模块接口。</li>
<li>module :　是一个对象，存储着与当前模块相关的一些属性和方法<ul>
<li>module.url: 根据模块系统的路径解析规则得到的模块绝对路径。 </li>
<li>一般情况下（没有在 define 中写 id 参数时），module.id 的值就是 module.uri，两者完全相同。</li>
<li>module.dependencies : 是一个数组，表示当前模块的依赖</li>
<li>module.exports : exports 是对该对象的一个引用。如果module.exports的指向改变了，那么exports就不在等于module.exports<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">require, exports, module</span>) </span>&#123;</div><div class="line">  <span class="comment">// 模块代码</span></div><div class="line">  <span class="built_in">require</span>(<span class="string">"./model"</span>);</div><div class="line">  exports.foo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">console</span>.log(<span class="built_in">module</span>.exports==exports);<span class="comment">//true</span></div><div class="line">  <span class="built_in">module</span>.exports = <span class="keyword">new</span> Person();</div><div class="line">  <span class="built_in">console</span>.log(<span class="built_in">module</span>.exports==exports);<span class="comment">//false</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/10/C06-webSocket/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qcyue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/tx1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shining Moon">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/10/C06-webSocket/" itemprop="url">
                  webSocket
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-05-10T00:00:00+08:00">
                2016-05-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/HTML5/" itemprop="url" rel="index">
                    <span itemprop="name">HTML5</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h1><ul>
<li>WebSocket是HTML5开始提供的一种在单个 TCP 连接上进行全双工通讯的协议。</li>
<li>在WebSocket API中，浏览器和服务器只需要一次握手的动作，然后浏览器和服务器之间就形成了一条快速通道。两者之间就可以数据相互传送。</li>
<li>浏览器通过 JavaScript 向服务器发出建立 WebSocket 连接的请求，连接建立以后，客户端和服务器端就可以通过 TCP 连接直接交换数据。</li>
<li>当你获取 Web Socket 连接后，你可以通过send()方法来向服务器发送数据，并通过 onmonmessage事件来接收服务器返回的数据。</li>
<li>创建WebSocket对象<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//第一个参数 url, 指定连接的 URL。</span></div><div class="line"><span class="comment">//第二个参数 protocol 是可选的，指定了可接受的子协议。</span></div><div class="line"><span class="keyword">var</span> Socket = <span class="keyword">new</span> WebSocket(url,[protocol]);</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="WebSocket起源"><a href="#WebSocket起源" class="headerlink" title="WebSocket起源"></a>WebSocket起源</h2><ul>
<li>在Web应用越来越复杂的今天，消息推送（即时通讯）已经成为一个非常重要的功能了，有了消息推送，Web页面就能够及时的接收到来自服务端的消息，为用户展现最好的交互体验。过去我们在实现Web页面的消息推送时，一般都是由页面发起请求，以轮询的方式向服务器获取数据，实现起来极为不便，业务逻辑也相对较为复杂。</li>
<li>为了解决这个问题，进而实现真正意义上的消息推送，HTML5定义了一套新的规范，这就是WebSocket。</li>
<li>WebSocket是一种用于在服务器和客户端之间实现高效的双向通信的机制，通过WebSocket，能够实现在一个HTTP连接上自由地双向收发消息。</li>
</ul>
<h2 id="WebSocket属性"><a href="#WebSocket属性" class="headerlink" title="WebSocket属性"></a>WebSocket属性</h2><ul>
<li><code>Socket.readyState</code>:只读属性，表示连接状态<ul>
<li>0：表示连接尚未建立</li>
<li>1：表示连接已建立，可以直接进行通信</li>
<li>2：表示连接正在进行关闭</li>
<li>3：表示连接已经关闭或者连接不能打开</li>
</ul>
</li>
<li><code>Socket.bufferedAmount</code>:只读属性<code>bufferedAmount</code>已被send()放入正在队列中等待传输，但是还没有发出的 UTF-8 文本字节数。</li>
</ul>
<h2 id="WebSocket事件"><a href="#WebSocket事件" class="headerlink" title="WebSocket事件"></a>WebSocket事件</h2><ul>
<li><code>Socket.onopen</code>：连接建立时触发 </li>
<li><code>Socket.onmessage</code>：客户端接收服务器数据时触发</li>
<li><code>Socket.onerror</code>: 通信错误时触发</li>
<li><code>Socket.onclose</code>: 连接关闭时触发</li>
</ul>
<h2 id="WebSocket方法"><a href="#WebSocket方法" class="headerlink" title="WebSocket方法"></a>WebSocket方法</h2><ul>
<li><code>Socket.send()</code>: 使用连接发送数据</li>
<li><code>Socket.close()</code>: 关闭连接</li>
</ul>
<h2 id="WebSocket使用"><a href="#WebSocket使用" class="headerlink" title="WebSocket使用"></a>WebSocket使用</h2><ul>
<li>WebSocket 协议本质上是一个基于 TCP 的协议。</li>
<li>为了建立一个 WebSocket 连接，客户端浏览器首先要向服务器发起一个 HTTP 请求，这个请求和通常的HTTP请求不同，包含了一些附加头信息，其中附加头信息”Upgrade: WebSocket”表明这是一个申请协议升级的 HTTP 请求，服务器端解析这些附加的头信息然后产生应答信息返回给客户端，客户端和服务器端的 WebSocket 连接就建立起来了，双方就可以通过这个连接通道自由的传递信息，并且这个连接会持续存在直到客户端或者服务器端的某一方主动的关闭连接。<h2 id="客户端的HTML和javascript"><a href="#客户端的HTML和javascript" class="headerlink" title="客户端的HTML和javascript"></a>客户端的HTML和javascript</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>webSocket<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">         <span class="function"><span class="keyword">function</span> <span class="title">WebSocketTest</span>(<span class="params"></span>)</span></div><div class="line">         &#123;</div><div class="line">            <span class="keyword">if</span> (<span class="string">"WebSocket"</span> <span class="keyword">in</span> <span class="built_in">window</span>)</div><div class="line">            &#123;</div><div class="line">               alert(<span class="string">"您的浏览器支持 WebSocket!"</span>);</div><div class="line">               </div><div class="line">               <span class="comment">// 打开一个 web socket</span></div><div class="line">               <span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">"ws://localhost:9998/echo"</span>);</div><div class="line">                </div><div class="line">               ws.onopen = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></div><div class="line">               &#123;</div><div class="line">                  <span class="comment">// Web Socket 已连接上，使用 send() 方法发送数据</span></div><div class="line">                  ws.send(<span class="string">"发送数据"</span>);</div><div class="line">                  alert(<span class="string">"数据发送中..."</span>);</div><div class="line">               &#125;;</div><div class="line">                </div><div class="line">               ws.onmessage = <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span></div><div class="line">               &#123; </div><div class="line">                  <span class="keyword">var</span> received_msg = evt.data;</div><div class="line">                  alert(<span class="string">"数据已接收..."</span>);</div><div class="line">               &#125;;</div><div class="line">                </div><div class="line">               ws.onclose = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></div><div class="line">               &#123; </div><div class="line">                  <span class="comment">// 关闭 websocket</span></div><div class="line">                  alert(<span class="string">"连接已关闭..."</span>); </div><div class="line">               &#125;;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="keyword">else</span></div><div class="line">            &#123;</div><div class="line">               <span class="comment">// 浏览器不支持 WebSocket</span></div><div class="line">               alert(<span class="string">"您的浏览器不支持 WebSocket!"</span>);</div><div class="line">            &#125;</div><div class="line">         &#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">        </div><div class="line">   <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"sse"</span>&gt;</span></div><div class="line">         <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:WebSocketTest()"</span>&gt;</span>运行 WebSocket<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">   <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="安装pywebsocket"><a href="#安装pywebsocket" class="headerlink" title="安装pywebsocket"></a>安装pywebsocket</h2><ul>
<li><p>在执行以上程序前，我们需要创建一个支持 WebSocket 的服务。从 pywebsocket 下载 mod_pywebsocket ,或者使用 git 命令下载：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> https://github.com/google/pywebsocket.git</div></pre></td></tr></table></figure>
</li>
<li><p>mod_pywebsocket 需要 python 环境支持</p>
</li>
<li>mod_pywebsocket 是一个 Apache HTTP 的 Web Socket扩展，安装步骤如下：<ul>
<li>解压下载的文件。</li>
<li>进入 pywebsocket 目录。</li>
<li>执行命令：<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ python setup.py build</div><div class="line">$ sudo python setup.py install</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="开启服务"><a href="#开启服务" class="headerlink" title="开启服务"></a>开启服务</h3><p>在 pywebsocket/mod_pywebsocket 目录下执行以下命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo python standalone.py -p 9998 -w ../example/</div></pre></td></tr></table></figure></p>
<p>以上命令会开启一个端口号为 9998 的服务，使用 -w 来设置处理程序 echo_wsh.py 所在的目录。<br>现在我们可以在Chrome浏览器打开前面创建的runoob_websocket.html文件。如果你的浏览器支持 WebSocket(), 点击”运行 WebSocket”，你就可以看到整个流程各个步骤弹出的窗口，</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/09/G02-cookie和session/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qcyue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/tx1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shining Moon">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/09/G02-cookie和session/" itemprop="url">
                  cookie
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-05-09T00:00:00+08:00">
                2016-05-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cookie和session/" itemprop="url" rel="index">
                    <span itemprop="name">cookie和session</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="cookie和session"><a href="#cookie和session" class="headerlink" title="cookie和session"></a>cookie和session</h1><ul>
<li>cookie是浏览器进行状态保持的一种技术</li>
<li>http是无状态的，无法记录客户端和服务器端的通信状态</li>
<li>url重写可以解决用户禁用cookie后，依然保持客户端与服务器端的正常通信状态。</li>
<li>由于 Http 协议的请求过程，是基于TCP/IP的，当客户端请求服务器，服务器处理后，进行响应，这个过程是无状态的。在有些时候，是需要保存一些客户端的请求信息，识别客户端的某些状态，智能的、有针对性的去分析某些客户端的习惯。这些时候，就需要去记录客户端的连接状态，识别请求的状态等。</li>
<li>cookie可以在客户端存储数据</li>
<li>在子路径设置的cookie在父路径下是获取不到的，反之则可；</li>
<li>不可以跨域获取cookie<h2 id="操作cookie"><a href="#操作cookie" class="headerlink" title="操作cookie"></a>操作cookie</h2></li>
<li>document.cookie   可以访问cookie</li>
<li>cookie的格式是键值对</li>
<li>多个cookie之间使用分号和空格隔开 ，如 <code>username=zhangsan; age=12</code><h3 id="cookie分类"><a href="#cookie分类" class="headerlink" title="cookie分类"></a>cookie分类</h3></li>
<li>session cookie   会话cookie  关闭浏览器窗口，cookie就消失</li>
<li>presistant cookie   持久cookie  需要设置过期时间<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">date.setDate(date.getDate()+<span class="number">5</span>);</div><div class="line"><span class="comment">//设置为从当前时间起五天后过期</span></div><div class="line"><span class="built_in">document</span>.cookie = <span class="string">"age=12;expires="</span>+date.toGMTString();</div><div class="line"><span class="built_in">document</span>.cookie=<span class="string">"username=zhangsan"</span>;<span class="comment">//设置多个cookie，cookie设置是累加的</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong> 封装cookie</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">   <span class="comment">//设置cookie</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setCookie</span>(<span class="params">key,value,expires</span>) </span>&#123;</div><div class="line">       <span class="built_in">document</span>.cookie = key + <span class="string">"="</span> + value + <span class="string">"; "</span> +<span class="string">"expires="</span>+expires + 	<span class="string">"; path=/"</span>;   <span class="comment">//   path=/  表示在当前的根目录有效</span></div><div class="line">   &#125;</div><div class="line">   <span class="comment">//获取cookie</span></div><div class="line">   <span class="function"><span class="keyword">function</span> <span class="title">getCookie</span>(<span class="params">cname</span>) </span>&#123;</div><div class="line">       <span class="keyword">var</span> cookies = <span class="built_in">document</span>.cookie;</div><div class="line">       <span class="keyword">var</span> arr = cookies.split(<span class="string">"; "</span>);</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</div><div class="line">           <span class="keyword">var</span> kv = arr[i].split(<span class="string">"="</span>);</div><div class="line">           <span class="keyword">if</span>(cname ==kv[<span class="number">0</span>])&#123;</div><div class="line">               <span class="keyword">return</span> kv[<span class="number">1</span>];</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure></p>
<h3 id="URL重写"><a href="#URL重写" class="headerlink" title="URL重写"></a>URL重写</h3><ul>
<li>该工作在服务器端进行</li>
<li>解决用户禁用cookie的情况下依然可以保存客户端和服务器的通信状态</li>
<li>URL 重写是拦截客户端传入 Web 请求URL并自动将其定向到到规则指定的 URL 的过程。比如浏览器发来请求 <code>http://blog.mocoder.com/hello.html</code>，服务器自动将这个请求中定向为<code>http://blog.mocoder.com/test.do?method=hello</code>。</li>
<li><strong> jquery 插件操作cookie</strong>   使用jquery.cookie.js<h2 id="session"><a href="#session" class="headerlink" title="session"></a>session</h2></li>
<li>当程序需要为某个客户端的请求创建一个session时，服务器首先检查这个客户端的请求里是否已包含了一个session标识（称为session id），如果已包含则说明以前已经为此客户端创建过session，服务器就按照session id把这个session检索出来使用（检索不到，会新建一个），如果客户端请求不包含session id，则为此客户端创建一个session并且生成一个与此session相关联的session id，session id的值应该是一个既不会重复，又不容易被找到规律的字符串，这个session id将被在本次响应中返回给客户端保存,交给cookie保存，这样在交互过程中浏览器可以自动的按照规则把这个标识发送给服务器。一般这个cookie的名字都是类似于SESSIONID。<h2 id="cookie-和-session的区别"><a href="#cookie-和-session的区别" class="headerlink" title="cookie 和 session的区别"></a>cookie 和 session的区别</h2></li>
<li>cookie数据存放在客户端，session数据存放在服务器上</li>
<li>cookie数据不安全,可以被别人获取，session则相对安全。</li>
<li>session数据会在一定的时间内保存在服务器上，默认是30min。当访问量增多的时候，会比较消耗服务器的性能</li>
<li>单个cookie保存的数据不能超过4K<h2 id="前端可以发送请求方式"><a href="#前端可以发送请求方式" class="headerlink" title="前端可以发送请求方式"></a>前端可以发送请求方式</h2></li>
<li>1、地址栏直接输入url</li>
<li>2、表单的action属性</li>
<li>3、a标签href</li>
<li>4、img的src</li>
<li>5、script的src</li>
<li>6、link的href</li>
<li>7、iframe 的src</li>
<li>8、ajax</li>
<li>9、postMessage  H5新的API</li>
<li>10、flash插件</li>
<li>11、location.href</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/07/F05-面向对象-杂乱知识点/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qcyue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/tx1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shining Moon">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/07/F05-面向对象-杂乱知识点/" itemprop="url">
                  面向对象-杂乱知识点
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-05-07T00:00:00+08:00">
                2016-05-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/OOP/" itemprop="url" rel="index">
                    <span itemprop="name">OOP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="杂乱知识梳理"><a href="#杂乱知识梳理" class="headerlink" title="杂乱知识梳理"></a>杂乱知识梳理</h1><h2 id="对象的体系结构"><a href="#对象的体系结构" class="headerlink" title="对象的体系结构"></a>对象的体系结构</h2><ul>
<li><ol>
<li>所有的实例对象都有一个<code>__proto__</code>属性，该属性指向产生该实例对象的构造函数的原型</li>
</ol>
</li>
<li><ol>
<li>所有的构造函数都有一个prototype属性，该属性本质上也是一个对象</li>
</ol>
</li>
<li><ol>
<li>所有的默认的原型对象都有一个contructor属性，该属性指向原型所属的构造函数</li>
</ol>
</li>
<li><ol>
<li>原型对象中有一个<code>__proto__</code>属性，该属性指向Object.prototype(Object的原型中没有<code>__proto__</code>,因为这里是原型链的终点)</li>
</ol>
</li>
<li><ol>
<li>所有的函数都是Function的实例对象</li>
</ol>
</li>
<li>6 .  Function本身也是Function的实例对象，所以<code>Function.__proto__===Function.prototype</code>;<h2 id="数组和类数组"><a href="#数组和类数组" class="headerlink" title="数组和类数组"></a>数组和类数组</h2></li>
<li>delete : 删除对象的属性<ul>
<li>全局作用域中var声明的变量，delete无法删除</li>
<li>不使用var声明的全局变量，可以使用delete删除<h3 id="类数组"><a href="#类数组" class="headerlink" title="类数组"></a>类数组</h3></li>
</ul>
</li>
<li>jquery对象本质上是类数组</li>
<li><p>类数组的属性是数值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="number">0</span>:<span class="string">"aaa"</span>,</div><div class="line">  <span class="number">1</span>:<span class="string">"bbb"</span>,</div><div class="line">  <span class="number">2</span>:<span class="string">"ccc"</span>,</div><div class="line">  <span class="attr">length</span>:<span class="number">3</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>将类数组转化成数组</p>
<ul>
<li>使用数组的slice方法</li>
<li>使用数组的push方法<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line"><span class="number">0</span>:<span class="string">"aaa"</span>,</div><div class="line"><span class="number">1</span>:<span class="string">"bbb"</span>,</div><div class="line"><span class="number">2</span>:<span class="string">"ccc"</span>,</div><div class="line"><span class="comment">//必须保证length属性的值为数字属性的长度</span></div><div class="line"><span class="comment">// 转化成数组的时候会截取length长度的属性个数为数组</span></div><div class="line">length:<span class="number">3</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> arr = [];</div><div class="line"><span class="comment">//var arr = [].slice.call(obj,0);</span></div><div class="line"><span class="comment">//还可以使用push</span></div><div class="line">[].push.apply(arr,obj);<span class="comment">//arr["aaa","bbb","ccc"];</span></div><div class="line"><span class="comment">//如果length的值为2，则arr["aaa","bbb"]</span></div><div class="line"><span class="built_in">console</span>.log(arr);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>call和apply的用法</strong></p>
</li>
<li>调用函数</li>
<li>改变所调用函数内部的this指向</li>
<li>转化类数组</li>
<li>借用其他对象的方法(本质上也是改变this的指向)<h2 id="对象类型检测"><a href="#对象类型检测" class="headerlink" title="对象类型检测"></a>对象类型检测</h2></li>
<li>运算符typeof  只能检测基本数据类型和object和function</li>
<li><code>Object.prototype.toString.call({})</code>可以检测出是哪一个对象</li>
<li><code>[]、/\d/</code>等直接调用<code>toString()</code>方法时，会打印字面量，因为这些对象内部对<code>toString()</code>方法进行封装，覆盖了<code>Object</code>原来的。直接调用<code>Object</code>中的<code>toString()</code>方法，会打印<code>[object Object]</code>这种形式的字符串<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ret1 = <span class="built_in">Object</span>.prototype.toString.call(&#123;&#125;);<span class="comment">//[object Object]</span></div><div class="line"><span class="keyword">var</span> ret2 = <span class="built_in">Object</span>.prototype.toString.call([]);<span class="comment">//[object Array]</span></div><div class="line"><span class="keyword">var</span> ret3 = <span class="built_in">Object</span>.prototype.toString.call(<span class="regexp">/\d/</span>);<span class="comment">//[object RegExp]</span></div><div class="line"><span class="keyword">var</span> ret4 = <span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">String</span>());<span class="comment">//[object String]</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="对象属性"><a href="#对象属性" class="headerlink" title="对象属性"></a>对象属性</h2><ul>
<li><p>Object.definePrototype(obj,attr,{})</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line"><span class="built_in">Object</span>.defineProperty(obj,<span class="string">"info"</span>,&#123;</div><div class="line">	<span class="attr">value</span>:<span class="string">"111"</span>,<span class="comment">//属性默认值</span></div><div class="line">	writable:<span class="literal">true</span>,<span class="comment">//控制是否可写</span></div><div class="line">	configurable:<span class="literal">true</span>,<span class="comment">//控制属性是否可删除</span></div><div class="line">	enumerable:<span class="literal">true</span><span class="comment">//是否可以通过for in访问到</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>get 和 set</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line"><span class="built_in">Object</span>.defineProperty(obj,<span class="string">"info"</span>,&#123;</div><div class="line"><span class="comment">//读取属性的时候调用get</span></div><div class="line">	get:<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.value;</div><div class="line">	&#125;,</div><div class="line">	<span class="comment">//设置属性的时候调用set，参数即为设置的值，</span></div><div class="line">	set:<span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</div><div class="line">		<span class="keyword">this</span>.value  =value;</div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h2><ul>
<li>“use strict”;ES5的新特性。严格模式对js代码结构有更严格的要求</li>
<li>普通函数中this指向window，严格模式下this指向undefined</li>
</ul>
<h2 id="对象实例判断"><a href="#对象实例判断" class="headerlink" title="对象实例判断"></a>对象实例判断</h2><ul>
<li>实例产生之后再修改构造函数的原型，那么对实例中的数据是没有影响的，但是会影响instanceof的判断，只有<code>实例对象.__proto__==构造函数.prototype</code>成立时才为true<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line"> Foo.prototype.flag = <span class="number">123</span>;</div><div class="line"> <span class="keyword">var</span> f = <span class="keyword">new</span> fn();</div><div class="line"> <span class="keyword">var</span> foo = <span class="keyword">new</span> Foo();</div><div class="line"> Foo.prototype = f;</div><div class="line"> <span class="built_in">console</span>.log(foo <span class="keyword">instanceof</span> Foo);<span class="comment">//false</span></div><div class="line"> <span class="built_in">console</span>.log(foo.__proto__ === Foo.prototype);<span class="comment">//false</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="拖拽案例"><a href="#拖拽案例" class="headerlink" title="拖拽案例"></a>拖拽案例</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line">    *&#123;</div><div class="line">        <span class="attribute">margin</span>: <span class="number">0</span>;</div><div class="line">        <span class="attribute">padding</span>: <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="selector-class">.drag</span>&#123;</div><div class="line">        <span class="attribute">width</span>: <span class="number">200px</span>;</div><div class="line">        <span class="attribute">height</span>:<span class="number">200px</span>;</div><div class="line">        <span class="attribute">background</span>: darkorange;</div><div class="line">        <span class="attribute">position</span>: absolute;</div><div class="line">        <span class="attribute">left</span>:<span class="number">100px</span>;</div><div class="line">        <span class="attribute">top</span>:<span class="number">100px</span>;</div><div class="line">    &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"drag"</span> <span class="attr">class</span>=<span class="string">"drag"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Drag</span>(<span class="params">id</span>) </span>&#123;</div><div class="line">        <span class="keyword">this</span>.target = <span class="built_in">document</span>.getElementById(id);</div><div class="line">        <span class="keyword">this</span>.disX = <span class="number">0</span>;</div><div class="line">        <span class="keyword">this</span>.disY = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//初始化</span></div><div class="line">    Drag.prototype.init = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> that = <span class="keyword">this</span>;</div><div class="line">        <span class="keyword">this</span>.target.onmousedown = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">            e = e||<span class="built_in">window</span>.event;</div><div class="line">            that.mousedownHandler(e);</div><div class="line">            <span class="built_in">document</span>.onmousemove = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">                e = e||<span class="built_in">window</span>.event;</div><div class="line">                that.mousemoveHandler(e);</div><div class="line">            &#125;;</div><div class="line">            <span class="built_in">document</span>.onmouseup = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                that.mouseupHandler();</div><div class="line">            &#125;</div><div class="line">            <span class="comment">//阻止默认行为：阻止文字默认的可拖拽效果</span></div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//鼠标按下事件处理</span></div><div class="line">    Drag.prototype.mousedownHandler = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">        <span class="comment">//计算鼠标距离div边界的距离</span></div><div class="line">        <span class="keyword">this</span>.disX = e.clientX-<span class="keyword">this</span>.target.offsetLeft;</div><div class="line">        <span class="keyword">this</span>.disY = e.clientY-<span class="keyword">this</span>.target.offsetTop;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//鼠标移动事件处理</span></div><div class="line">    Drag.prototype.mousemoveHandler = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">        <span class="comment">//设置div移动时不超出屏幕</span></div><div class="line">        <span class="keyword">var</span> limitX = e.clientX-<span class="keyword">this</span>.disX;</div><div class="line">        <span class="keyword">var</span> limitY = e.clientY-<span class="keyword">this</span>.disY</div><div class="line">        limitX = limitX&lt;=<span class="number">0</span>?<span class="number">0</span>:limitX;</div><div class="line">        limitX = limitX&gt;=(<span class="built_in">document</span>.documentElement.clientWidth-<span class="keyword">this</span>.target.offsetWidth)?(<span class="built_in">document</span>.documentElement.clientWidth-<span class="keyword">this</span>.target.offsetWidth):limitX;</div><div class="line">        limitY =  limitY&lt;=<span class="number">0</span>?<span class="number">0</span>:limitY;</div><div class="line">        limitY = limitY&gt;=(<span class="built_in">document</span>.documentElement.clientHeight-<span class="keyword">this</span>.target.offsetHeight)?(<span class="built_in">document</span>.documentElement.clientHeight-<span class="keyword">this</span>.target.offsetHeight):limitY;</div><div class="line">        <span class="comment">//设置鼠标移动时div的位置</span></div><div class="line">        <span class="keyword">this</span>.target.style.left = limitX+ <span class="string">"px"</span>;</div><div class="line">        <span class="keyword">this</span>.target.style.top = limitY + <span class="string">"px"</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">//鼠标抬起事件处理</span></div><div class="line">    Drag.prototype.mouseupHandler = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">document</span>.onmousemove  = <span class="literal">null</span>;</div><div class="line">        <span class="built_in">document</span>.onmouseup = <span class="literal">null</span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> drag = <span class="keyword">new</span> Drag(<span class="string">"drag"</span>);</div><div class="line">        drag.init();</div><div class="line">    &#125;;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h2><ul>
<li><p>第一题</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = &#123;<span class="attr">n</span>:<span class="number">1</span>&#125;;</div><div class="line"><span class="keyword">var</span> b = a;</div><div class="line">a.x = a = &#123;<span class="attr">n</span>:<span class="number">2</span>&#125;;</div><div class="line"><span class="comment">// .的优先级最高，会先给x属性分配一块内存地址，a = &#123;n:2&#125;改变了a的指向，最后将&#123;n:2&#125;赋给了属性x所在的内存地址</span></div><div class="line"><span class="built_in">console</span>.log(a.x);<span class="comment">//undefined</span></div><div class="line"><span class="built_in">console</span>.log(b.x);<span class="comment">//&#123;n:2&#125;</span></div></pre></td></tr></table></figure>
</li>
<li><p>第二题</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = &#123;<span class="attr">name</span>:<span class="string">'zhangsan'</span>&#125;; </div><div class="line"><span class="keyword">var</span> b = &#123;<span class="attr">age</span> : <span class="number">26</span>&#125;; </div><div class="line"><span class="keyword">var</span> arr = []; </div><div class="line">arr[a] = <span class="number">123</span>; </div><div class="line">arr[b] = <span class="number">456</span>; </div><div class="line"><span class="built_in">console</span>.log(arr.length);<span class="comment">//0  添加的是属性不是索引</span></div><div class="line"><span class="built_in">console</span>.dir(arr);</div><div class="line"><span class="comment">//arr 中只有一个属性，在为arr添加属性的时候，会调用toString()方法，将变量a进行转化，进行转化后为[object Object],所以arr只有一个属性，值为456，覆盖了123</span></div></pre></td></tr></table></figure></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/07/F04-事件处理机制/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qcyue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/tx1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shining Moon">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/07/F04-事件处理机制/" itemprop="url">
                  事件处理机制
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-05-07T00:00:00+08:00">
                2016-05-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/OOP/" itemprop="url" rel="index">
                    <span itemprop="name">OOP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="事件处理机制"><a href="#事件处理机制" class="headerlink" title="事件处理机制"></a>事件处理机制</h1><ul>
<li>JavaScript是单线程的</li>
<li>浏览器本身是多线程的<ul>
<li>页面标签的渲染</li>
<li>网络通信</li>
<li>解析js运行<h2 id="事件队列（任务队列）"><a href="#事件队列（任务队列）" class="headerlink" title="事件队列（任务队列）"></a>事件队列（任务队列）</h2></li>
</ul>
</li>
<li>JavaScript的单线程决定了事件的执行需要排队，前一个任务执行完毕，才会执行后一个任务</li>
<li>能够进事件队列的函数<ul>
<li>定时函数(setTimeout,setInterval)</li>
<li>事件函数</li>
<li>ajax的回调函数，即onreadystatechange指向的函数<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="number">111</span>);</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</div><div class="line"><span class="comment">//遇到setTimeout会先将要执行的函数放进事件队列中，继续执行主线程，当主线程执行完毕后，才执行事件队列中的函数,因此，定时器中的函数只能在最后执行</span></div><div class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(i);</div><div class="line">  &#125;,<span class="number">0</span>);<span class="comment">//0 代表按照浏览器的默认最小延时执行代码</span></div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(<span class="number">222</span>);</div><div class="line"><span class="comment">//以下为输出结果</span></div><div class="line"><span class="comment">//111</span></div><div class="line"><span class="comment">//222</span></div><div class="line"><span class="comment">//3</span></div><div class="line"><span class="comment">//3</span></div><div class="line"><span class="comment">//3</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="事件轮询-Event-Loop"><a href="#事件轮询-Event-Loop" class="headerlink" title="事件轮询(Event Loop)"></a>事件轮询(Event Loop)</h2><ul>
<li>主线程会循环不断的从事件队列中读取事件</li>
<li>当读取到事件时，会首先判断主线程是否空闲，再判断当前函数的执行条件是否满足，如果上述两个要求均满足，则执行事件</li>
<li>setTimeout只是将事件放入了事件队列，必须等到主线程空闲才会去执行。因此，定时函数不一定会在执行的时间内执行<h2 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h2></li>
<li>行内绑定</li>
<li>绑定到DOM元素上</li>
<li>addEventListener / attachEvent<ul>
<li>addEventListener(“事件名”，“事件处理函数”，false);设置为false为允许冒泡<h3 id="阻止冒泡和阻止默认行为"><a href="#阻止冒泡和阻止默认行为" class="headerlink" title="阻止冒泡和阻止默认行为"></a>阻止冒泡和阻止默认行为</h3></li>
</ul>
</li>
<li>阻止冒泡：event.stopPropagation() / event.cancelBubble = true(兼容IE)</li>
<li>阻止默认行为：event.preventDefault() / event.returnValue = false(兼容IE)或者return false(不能阻止使用 addEventListener 绑定的事件)</li>
<li>在jQuery中，return false既可以阻止冒泡，又可以阻止默认行为<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"www.baidu.com"</span> <span class="attr">id</span>=<span class="string">"jump"</span>&gt;</span>跳转<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="keyword">var</span> a = <span class="built_in">document</span>.getElementById(<span class="string">"jump"</span>);</div><div class="line">a.addEventListener(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="comment">//此处不能阻止默认行为</span></div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;);</div><div class="line">a.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">//此处可以阻止默认行为</span></div><div class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h2><ul>
<li>将子元素的事件委托到父元素中处理</li>
<li>jQuery中的on和delegate可是实现事件委托，原理如下<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 6<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">//使用该方法需要给多个元素绑定事件，消耗内存</span></div><div class="line">	<span class="comment">/*var lis = document.getElementsByTagName("li");</span></div><div class="line">    for(var i=0;i&lt;lis.length;i++)&#123;</div><div class="line">        lis[i].onclick = function()&#123;</div><div class="line">            console.log(this.innerHTML);</div><div class="line">        &#125;</div><div class="line">    &#125;*/</div><div class="line"><span class="comment">//使用事件委托只需要给父元素绑定事件即可</span></div><div class="line">    <span class="keyword">var</span> ul = <span class="built_in">document</span>.getElementById(<span class="string">"target"</span>);</div><div class="line">    ul.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">        event = event||<span class="built_in">window</span>.event;</div><div class="line">        <span class="keyword">var</span> target = event.target||event.srcElement;</div><div class="line">        <span class="built_in">console</span>.log(target.innerHTML);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="自定义事件"><a href="#自定义事件" class="headerlink" title="自定义事件"></a>自定义事件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addEvent</span>(<span class="params">obj,type,fn</span>)</span>&#123;</div><div class="line">    obj.listener = obj.listener||&#123;&#125;;</div><div class="line">    obj.listener[type] = obj.listener[type]||[];</div><div class="line">    obj.listener[type].push(fn);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fireEvent</span>(<span class="params">obj,type</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> arr = obj.listener[type];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</div><div class="line">        arr[i]();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line">addEvent(obj,<span class="string">"aaa"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="number">111</span>)&#125;);</div><div class="line">addEvent(obj,<span class="string">"bbb"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="number">222</span>)&#125;);</div><div class="line">addEvent(obj,<span class="string">"ccc"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="number">333</span>)&#125;);</div><div class="line">addEvent(obj,<span class="string">"ddd"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="number">444</span>)&#125;);</div><div class="line">fireEvent(obj,<span class="string">"aaa"</span>);</div><div class="line"><span class="comment">/*</span></div><div class="line">//自定义事件的数据结构</div><div class="line">obj.listener = &#123;&#125;;</div><div class="line">//属性作为事件名称，数组为放置事件函数的列表</div><div class="line">obj.listener.aaa = [function()&#123;&#125;];</div><div class="line">*/</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/04/F03-面向对象-闭包/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qcyue">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/tx1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shining Moon">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/04/F03-面向对象-闭包/" itemprop="url">
                  闭包
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-05-04T00:00:00+08:00">
                2016-05-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/OOP/" itemprop="url" rel="index">
                    <span itemprop="name">OOP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="作用域与闭包"><a href="#作用域与闭包" class="headerlink" title="作用域与闭包"></a>作用域与闭包</h1><h2 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h2><ul>
<li>全局作用域</li>
<li>函数作用域</li>
<li><strong>没有块级作用域</strong><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="keyword">var</span> a = <span class="number">123</span>;</div><div class="line">  <span class="built_in">console</span>.log(a);</div><div class="line">&#125;</div><div class="line"><span class="comment">//可以访问的到a</span></div><div class="line"><span class="built_in">console</span>.log(a);</div><div class="line"><span class="comment">//if和for也构成代码块</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(i);<span class="comment">//5</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="作用域链"><a href="#作用域链" class="headerlink" title="作用域链"></a>作用域链</h2><ul>
<li>函数内层作用域可以访问函数外层作用，反之则不可。</li>
<li>平级的函数之间不可以相互访问<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> b = <span class="number">20</span>;</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> c = <span class="number">30</span>;</div><div class="line">		<span class="built_in">console</span>.log(a+b+c);</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">var</span> d = <span class="number">40</span>;</div><div class="line">		<span class="built_in">console</span>.log(a+b+d);</div><div class="line">	&#125;</div><div class="line">	fn();</div><div class="line">	fn1();</div><div class="line">&#125;</div><div class="line">foo();</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="js运行分为两个阶段"><a href="#js运行分为两个阶段" class="headerlink" title="js运行分为两个阶段"></a>js运行分为两个阶段</h2><ul>
<li>预解析</li>
<li>全局预解析<ul>
<li>所有的变量和函数声明都会提前，同名的函数和变量，函数的优先级高(即先提升变量，再提升函数)</li>
</ul>
</li>
<li><p>函数内部预解析</p>
<ul>
<li>所有变量、函数和形参都会预解析（函数&gt;形参&gt;变量）<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a</span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(a);<span class="comment">//输出的是function a()&#123;&#125;</span></div><div class="line">	<span class="keyword">var</span> a = <span class="number">123</span>;</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">&#125;</div><div class="line">foo(<span class="number">123</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>执行</p>
<ul>
<li>先预解析全局作用域，然后执行全局作用域中的代码，再执行全局代码的过程中，遇到函数调用，就会先进行函数的预解析，再执行内部的代码</li>
</ul>
</li>
</ul>
<h2 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h2><ul>
<li>函数的嵌套形成闭包(内层函数和内层函数所处的作用域)</li>
<li>闭包的组成：内层函数+内层函数所处的作用域</li>
<li>闭包的作用：延长变量的生命周期，缓存中间状态值</li>
<li>闭包可以操作函数内部的变量(间接)</li>
<li>一般函数在执行完毕后，所处的环境会消失，闭包不会，因为闭包中还存在着对该环境的引用<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> n = <span class="built_in">Math</span>.random();</div><div class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">return</span> n;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> inner = foo();</div><div class="line"><span class="keyword">var</span> ret = inner();</div><div class="line"><span class="keyword">var</span> ret1 = inner();</div><div class="line"><span class="comment">//两个值相同</span></div><div class="line"><span class="built_in">console</span>.log(ret);</div><div class="line"><span class="built_in">console</span>.log(ret1);</div></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">	<span class="keyword">var</span> arr = [];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</div><div class="line">		arr[i] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">          <span class="comment">//当前的环境下没有i，所以就会向上查找，当找到i时，循环已经结束，此时i=3</span></div><div class="line">			<span class="built_in">console</span>.log(i);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	arr[<span class="number">0</span>]();<span class="comment">//3</span></div><div class="line">	arr[<span class="number">1</span>]();<span class="comment">//3</span></div><div class="line">	arr[<span class="number">2</span>]();<span class="comment">//3</span></div><div class="line"><span class="comment">//下面的代码的执行结果是0,1，2</span></div><div class="line"><span class="comment">//因为i在arr[i]被调用的时候重新赋值了</span></div><div class="line">	<span class="comment">/*for(var i=0;i&lt;3;i++)&#123;</span></div><div class="line">      arr[i]();</div><div class="line">	&#125;*/</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</div><div class="line">	arr[i] = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="built_in">console</span>.log(num);</div><div class="line">		&#125;</div><div class="line">	&#125;)(i);</div><div class="line">&#125;</div><div class="line">arr[<span class="number">0</span>]();<span class="comment">//0</span></div><div class="line">arr[<span class="number">1</span>]();<span class="comment">//1</span></div><div class="line">arr[<span class="number">2</span>]();<span class="comment">//2</span></div></pre></td></tr></table></figure>
<ul>
<li><p><strong>经典题型</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> arr = [];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</div><div class="line">		<span class="keyword">return</span> arr[i] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">return</span> i;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//为什么此时的i不会被重新赋值？？？</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</div><div class="line">	<span class="built_in">console</span>.log(foo()[i]());<span class="comment">//输出为10个10</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>如果想要达到预期效果，可以使用闭包</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> arr = [];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</div><div class="line">		<span class="keyword">return</span> (<span class="function"><span class="keyword">function</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">			<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="keyword">return</span> n;</div><div class="line">			&#125;</div><div class="line">		&#125;)(i);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</div><div class="line">	<span class="built_in">console</span>.log(foo()[i]());<span class="comment">//输出0-9；</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><strong>闭包的机制领悟</strong></li>
<li>闭包是能够有权访问其他环境中变量的函数。也就是闭包可以记住它被创建时的环境。</li>
<li>浏览器用“栈”来维护执行上下文（也就是函数的运行环境），当前正在运行的函数会处于栈顶，当函数执行完毕后会出栈，然后将下一个元素作为当前的上下文。</li>
<li>当遇到闭包时，外部函数并未出栈，闭包就已经进栈了，所以外部函数还在栈中占据着一块空间。实际上外部函数的数据被存在了堆中，这样才能在闭包执行完毕后（已经出栈后）内部的变量还一直存在。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//函数a进栈</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> num = <span class="number">1</span>;</div><div class="line"><span class="comment">//当执行到该处时，函数a还未执行完毕，此时，闭包进栈</span></div><div class="line"><span class="comment">//由于栈遵循先入后出的原则，因此在闭包执行之前，函数a不会出栈</span></div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    num++;</div><div class="line">    <span class="built_in">console</span>.log(num);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/tx1.jpg"
               alt="Qcyue" />
          <p class="site-author-name" itemprop="name">Qcyue</p>
           
              <p class="site-description motion-element" itemprop="description">生活，我们是认真的！</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">79</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Qcyue</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

</body>
</html>
